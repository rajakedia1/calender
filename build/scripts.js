"use strict";var listOfHolidays,date=new Date,week=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],month=["January","February","March","April","May","June","July","August","September","October","November","December","January"],weekInYear=52,dayinmonth=[31,28,31,30,31,30,31,31,30,31,30,31];function findHoliday(t,n,e){return listOfHolidays.filter(function(e){return e.d===t&&e.m===n})}function createDayNode(e,t){var n=document.createElement("div");n.classList.add("day");var a=document.createElement("span"),r=document.createTextNode(e);return a.classList.add("title"),t||a.classList.add("active"),a.appendChild(r),n.appendChild(a),n}function createMonthNode(e){var t=document.createElement("div");return t.classList.add("months"),t.id=month[e],t}function createDateNode(e,t,n,a){var r=document.createElement("div");r.classList.add("date"),n||r.classList.add("sun");var o=document.createElement("span"),d=document.createTextNode(e);o.classList.add("text"),t===date.getDate()&&(1==t&&a===date.getMonth()||1!=t&&a-1===date.getMonth())&&(o.classList.add("active"),r.classList.add("date-active")),o.appendChild(d);var i=document.createElement("div");if(i.classList.add("date-box"),i.appendChild(o),1===t&&500<=window.innerWidth){var c=document.createElement("p");1===date.getDate()?c.classList.add("month"):c.classList.add("month-active"),c.innerHTML=month[a].substr(0,3),i.appendChild(c)}r.appendChild(i);var s=findHoliday(e,1!==e?a-1:a);return s&&s.forEach(function(e){var t=document.createElement("div");t.classList.add("fest"),t.innerHTML=e.holiday,r.appendChild(t)}),r}function calcFirstDayofYear(e){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,n=((1<arguments.length&&void 0!==arguments[1]?arguments[1]:0)+10)%12+1,a=e%100-(10<n?1:0),r=Math.floor(e/100),o=t+Math.floor((13*n-1)/5)+a+Math.floor(a/4)+Math.floor(r/4)-2*r;return(0<o?o:(o-7*(Math.floor(o)+2))%7)%7}function isElementInViewport(e){var t=e.getBoundingClientRect();return(0<t.top?window.innerHeight-t.top:t.bottom)>=window.innerHeight/2}var mNode=[];function main(){showWeekRow(),fetch("https://raw.githubusercontent.com/rajakedia1/calender/master/js/holidays.json").then(function(e){return e.json()}).then(function(e){listOfHolidays=e.map(function(e){var t=new Date(e.date+" 2019");return e.d=t.getDate(),e.m=t.getMonth(),e}),showCalender(),document.getElementById("loader").innerHTML="",document.getElementById(month[date.getMonth()]).scrollIntoView(),scrollListener()})}function showTitle(e){var t=document.createTextNode(e+" ");document.querySelector(".nav .h1").replaceChild(t,document.querySelector(".nav .h1").childNodes[0]),document.querySelector(".nav .h1 .span").innerHTML=date.getFullYear()}function showWeekRow(){week.map(function(e,t){return document.querySelector(".nav .row").appendChild(createDayNode(e,t))})}function showCalender(){for(var e=[],t=0;t<weekInYear+2;t++){e.push([]);for(var n=0;n<7;n++)e[t].push(1)}var a=0;for(t=(l=calcFirstDayofYear(date.getFullYear()))-1;0<=t;t--)e[0][t]=31-(l-1-t);for(t=0;t<12;t++)for(n=0;n<dayinmonth[t];n++)e[a][l]=n+1,7==++l&&(l=0,a++);for(t=l;t<7;t++)e[a][t]=t-l+1;var r=[],o=[],d=[];for(t=0;t<weekInYear+1;t++){var i=document.createElement("div");for(i.classList.add("row"),n=0;n<7;n++){var c=createDateNode(e[t][n],e[t][n],n,r.length);i.appendChild(c),1==e[t][n]&&(r.push(t),mNode.push(d),d=[]),d.push(c)}o.push(i)}mNode.push(d);var s=createMonthNode(0),l=1;for(t=0;t<weekInYear+1;t++)0<t&&t===r[l]?(l++,document.querySelector(".wrapper").appendChild(s),(s=createMonthNode(l-1)).appendChild(o[t])):s.appendChild(o[t]);document.querySelector(".wrapper").appendChild(s)}function scrollListener(){document.querySelectorAll(".wrapper .months").forEach(function(e,t){e.classList.remove("actived"),isElementInViewport(e)&&(mNode.forEach(function(e){return e.forEach(function(e){e.classList.remove("active-m")})}),e.classList.add("actived"),showTitle(month[t]),mNode[t+1].forEach(function(e){e.classList.add("active-m")}))})}main(),document.querySelector(".wrapper").addEventListener("scroll",scrollListener,!1);